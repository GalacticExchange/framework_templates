#!/usr/bin/env bash



INIT_LOCK="/INIT_LOCK"

while :  [ -f "$INIT_LOCK" ];
do
sleep 0.1
done





rm /tmp/*.pid
set +e



service ssh start

service hadoop-hdfs-namenode start

hdfs dfsadmin -safemode leave

service hadoop-yarn-resourcemanager start
sudo -u hdfs hadoop fs -ls /user/hdfs

if [ $? -eq 1 ]
then


export FIRST_RUN

fi

sleep 30

service mysql start

service hadoop-httpfs start

service zookeeper-server start
service spark-history-server start
service spark-master start
service spark-server start
service kafka-server start

sleep 30

service hue start

service hadoop-mapreduce-historyserver start
service hadoop-yarn-proxyserver start
service hadoop-yarn-resourcemanager start
# ENTERPRISE service hbase-master start
# ENTERPRISE service hbase-thrift start
# ENTERPRISE service hbase-rest start
service hive-metastore start
export HIVE_PORT=10001
service hive-server start

sleep 100
rm -rf  /var/lib/hive/metastore/metastore_db/*.lck
service hive-server2 start
service webhcat-server start
# ENTERPRISE service impala-catalog start

# ENTERPRISE service impala-state-store start

sleep 100

service sqoop2-server start


# ENTERPRISE if [[ -v FIRST_RUN ]]
# ENTERPRISE then
# ENTERPRISE sudo oozie-setup sharelib create -fs hdfs://localhost:8020 -locallib /usr/lib/oozie/oozie-sharelib-yarn
# ENTERPRISE fi



# ENTERPRISE service oozie start


